"use strict";angular.module("sw.plugin.base",["sw.plugins"]).factory("base",["$q","$log",function(a,e){function t(t,s){e.debug("sw:plugin","base");var n=a.defer();if(s&&s.paths){var r={},h=Number.MAX_VALUE;angular.forEach(s.paths,function(a,e){r[e]=e.split("/"),"/"===e[0]&&r[e].shift(),h=Math.min(h,r[e].length)});for(var i=Object.keys(s.paths),u=[],l=0;l<h;l++){var b=r[i[0]][l];if(/\{.+\}/.test(b)||r[i[0]].length<=1)break;for(var f=!0,g=0;g<i.length;g++)if(r[i[g]][l]!==b){f=!1;break}if(!f)break;u.push(b)}if(u.length>0){var o=u.join("/");e.debug("sw:plugin:base:extracted",o),s.basePath=s.basePath||"/",s.basePath=s.basePath+("/"===s.basePath[s.basePath.length-1]?"":"/")+o,angular.forEach(i,function(a){s.paths["/"+r[a].slice(u.length).join("/")]=s.paths[a],delete s.paths[a]})}}return n.resolve(!0),n.promise}return{execute:t}}]).run(["plugins","base",function(a,e){a.add(a.BEFORE_PARSE,e)}]);